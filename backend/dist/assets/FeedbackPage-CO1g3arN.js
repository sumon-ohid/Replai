import{al as ae,aq as N,w as n,x as H,j as e,an as ne,ao as s,as as p,ar as ie,ap as i,U as I,ay as U,av as Y,aw as L,aE as oe,a_ as le,a$ as V,Z as de,y as ce,P as q,aN as G,a1 as me,W as xe,Y as pe,T as he,X as ue}from"./mui-core-BvDVqQNt.js";import{a as x}from"./react-vendor-DaePdQuf.js";import{S as be,A as ge,H as ye}from"./SideMenu-DSoO3BAJ.js";import{A as je}from"./index-CEV_yOxs.js";import{D as fe}from"./Footer-DN6xm231.js";import{aM as ve,bd as Ce,aA as ke,af as we,be as Se,g as O,bf as $e,bg as Ie,bh as Q}from"./mui-icons-BrpH9ATo.js";import{a as v}from"./utils-DW_MHI2K.js";import{m as h,A as X}from"./animations-GQCX1BUJ.js";import"./ColorModeIconDropdown-BU6ylaH-.js";const C="https://replai.tech",Ae={hidden:{opacity:0},visible:{opacity:1,transition:{staggerChildren:.1}}},k={hidden:{opacity:0,y:20},visible:{opacity:1,y:0,transition:{type:"spring",stiffness:300,damping:24}}};function Pe(Z){const a=ae(),J=N(a.breakpoints.down("sm"));N(a.breakpoints.down("md"));const[u,A]=x.useState(null),[w,R]=x.useState(""),[y,j]=x.useState([]),[S,T]=x.useState({}),[b,f]=x.useState(null),[W,z]=x.useState(!1);x.useEffect(()=>{K()},[]);const K=async()=>{try{const t=await v.get(`${C}/api/feedback/all`),r=t.data;j(t.data)}catch(t){console.error("Error fetching feedback:",t)}},ee=async t=>{t.preventDefault(),z(!0);try{const r=localStorage.getItem("token");if(!r){console.error("No token found");return}const o=await v.post(`${C}/api/feedback/submit`,{rating:u,comments:w},{headers:{Authorization:`Bearer ${r}`}});j(m=>[o.data,...m]),A(null),R(""),f({type:"success",message:"Your feedback has been submitted successfully! Thank you for helping us improve."}),setTimeout(()=>f(null),5e3)}catch(r){console.error("Error submitting feedback:",r),f({type:"error",message:"Please provide both a rating and comment before submitting feedback."})}finally{z(!1)}},te=async t=>{var r;try{const o=localStorage.getItem("token");if(!o){console.error("No token found");return}if(!((r=S[t])!=null&&r.trim()))return;const m=await v.post(`${C}/api/feedback/comment/${t}`,{comment:S[t]},{headers:{Authorization:`Bearer ${o}`}});j(c=>c.map(g=>g._id===t?m.data:g)),T(c=>({...c,[t]:""}))}catch(o){console.error("Error submitting comment:",o)}},re=async t=>{try{const r=localStorage.getItem("token");if(!r){console.error("No token found");return}const o=await v.post(`${C}/api/feedback/like/${t}`,{},{headers:{Authorization:`Bearer ${r}`}});j(m=>m.map(c=>c._id===t?o.data:c))}catch(r){console.error("Error liking feedback:",r)}},se=(t,r)=>{T(o=>({...o,[t]:r}))},B=t=>{if(!t)return"";const r=new Date(t);return new Intl.DateTimeFormat("en-US",{month:"short",day:"numeric",year:"numeric"}).format(r)},l=a.palette.primary.main,$=a.palette.secondary.main;return`${n(l,.15)}${n($,.05)}`,`${l}${a.palette.mode==="dark"?H($,.1):$}`,e.jsxs(je,{...Z,children:[e.jsx(ne,{enableColorScheme:!0}),e.jsxs(s,{sx:{display:"flex"},children:[e.jsx(be,{}),e.jsx(ge,{}),e.jsxs(s,{component:"main",sx:t=>({flexGrow:1,backgroundColor:n(t.palette.background.default,1),overflow:"auto",minHeight:"100vh"}),children:[e.jsx(p,{spacing:2,sx:{alignItems:"center",mx:{xs:1,sm:2,md:3},pb:2,mt:{xs:8,md:0}},children:e.jsx(ye,{})}),e.jsx(ie,{maxWidth:"lg",children:e.jsxs(s,{component:h.div,variants:Ae,initial:"hidden",animate:"visible",sx:{px:{xs:1,sm:2},py:3},children:[e.jsxs(s,{component:h.div,variants:k,sx:{mb:5,textAlign:"center"},children:[e.jsx(i,{variant:J?"h4":"h3",component:"h1",sx:{fontWeight:800,background:"linear-gradient(90deg,rgb(0, 98, 255),rgb(43, 156, 255))",WebkitBackgroundClip:"text",WebkitTextFillColor:"transparent",mb:1},children:"Your Feedback Matters"}),e.jsx(i,{variant:"body1",color:"text.secondary",sx:{maxWidth:700,mx:"auto",mb:3,px:2},children:"Help us build a better experience by sharing your thoughts and suggestions. Every opinion helps us improve."}),e.jsx(p,{direction:{xs:"row",sm:"row"},spacing:{xs:1,sm:3},justifyContent:"center",sx:{mt:2},width:1,children:[{icon:e.jsx(ve,{}),label:"Top rated product"},{icon:e.jsx(Ce,{}),label:`${y.length} feedbacks`},{icon:e.jsx(ke,{}),label:"Constant improvements"}].map((t,r)=>e.jsx(I,{icon:t.icon,label:t.label,variant:"outlined",color:"primary",sx:{borderRadius:"16px",px:1,"& .MuiChip-icon":{color:l},width:{xs:"30%",sm:"auto"}}},r))})]}),e.jsx(s,{sx:{mb:8,alignItems:"center",background:`radial-gradient(circle, ${n(l,.2)} 0%, transparent 70%)`},children:e.jsx(U,{item:!0,xs:12,md:7,children:e.jsx(s,{component:h.div,variants:k,sx:{background:`radial-gradient(circle, ${n(l,.2)} 0%, transparent 70%)`},children:e.jsx(Y,{elevation:0,sx:{borderRadius:4,overflow:"hidden",border:1,borderColor:"divider",boxShadow:a.palette.mode==="dark"?`0 8px 32px ${n(a.palette.common.black,.2)}`:`0 8px 32px ${n(a.palette.primary.main,.1)}`},children:e.jsxs(L,{sx:{p:{xs:3,sm:4}},children:[e.jsx(X,{mode:"wait",children:b&&e.jsx(h.div,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},exit:{opacity:0},children:e.jsxs(oe,{severity:b.type,variant:"filled",onClose:()=>f(null),sx:{mb:3,borderRadius:2,boxShadow:`0 4px 12px ${n(b.type==="success"?a.palette.success.main:a.palette.error.main,.2)}`},children:[e.jsx(le,{sx:{fontWeight:600},children:b.type==="success"?"Thank You!":"Action Required"}),b.message]})})}),e.jsxs(s,{component:"form",onSubmit:ee,noValidate:!0,children:[e.jsxs(i,{variant:"body1",sx:{fontWeight:600,mb:1,display:"flex",alignItems:"center",gap:1},children:[e.jsx(we,{fontSize:"small",color:"primary"}),"How would you rate your experience?"]}),e.jsxs(s,{sx:{mb:4,display:"flex",alignItems:"left",flexDirection:"column",mt:3},children:[e.jsx(V,{name:"feedback-rating",value:u,onChange:(t,r)=>A(r),size:"large",sx:{mb:1,"& .MuiRating-iconFilled":{color:a.palette.primary.main}}}),e.jsx(i,{variant:"caption",color:"text.secondary",children:u?u<3?"We'll work on improving":u<5?"Thanks! We're doing well":"Excellent! Thank you":"Select a rating"})]}),e.jsxs(i,{variant:"body1",sx:{fontWeight:600,mb:1,display:"flex",alignItems:"center",gap:1},children:[e.jsx(Se,{fontSize:"small",color:"primary"}),"Tell us more about your experience"]}),e.jsx(U,{item:!0,xs:12,children:e.jsx("textarea",{name:"textarea",id:"textarea",rows:6,cols:65,required:!0,style:{width:"100%",height:"100%",padding:"10px",borderRadius:"5px",border:".5px solid rgba(142, 142, 142, 0.48)",backgroundColor:"transparent",resize:"none"},placeholder:"Comments",value:w,onChange:t=>R(t.target.value),children:w})}),e.jsx(de,{type:"submit",variant:"contained",disabled:W,endIcon:e.jsx(O,{}),sx:{mt:3,fontSize:"1rem",py:1.2,px:3,borderRadius:2,textTransform:"none",fontWeight:600,boxShadow:`0 4px 14px ${n(a.palette.primary.main,.3)}`,background:a.palette.mode==="dark"?`linear-gradient(90deg, ${l}, ${ce(l,.2)})`:`linear-gradient(90deg, ${l}, ${H(l,.1)})`,"&:hover":{boxShadow:`0 6px 20px ${n(a.palette.primary.main,.4)}`}},children:W?"Submitting...":"Submit Feedback"})]})]})})})})}),e.jsxs(s,{component:h.div,variants:k,sx:{mb:3},children:[e.jsxs(s,{sx:{display:"flex",flexDirection:{xs:"column",sm:"row"},justifyContent:"space-between",alignItems:{xs:"flex-start",sm:"center"},mb:4},children:[e.jsxs(s,{children:[e.jsx(i,{variant:"h4",component:"h2",fontWeight:700,sx:{mb:1},children:"Community Feedback"}),e.jsx(i,{variant:"body1",color:"text.secondary",children:"See what others are saying about Replai"})]}),e.jsx(I,{label:`${y.length} Contributions`,color:"primary",variant:"outlined",sx:{mt:{xs:2,sm:0},fontWeight:500,px:1,borderRadius:"12px"}})]}),e.jsx(X,{children:y.length===0?e.jsxs(q,{elevation:0,sx:{p:4,textAlign:"center",borderRadius:4,border:`1px dashed ${n(a.palette.divider,.8)}`},children:[e.jsx(i,{variant:"h6",color:"text.secondary",gutterBottom:!0,children:"Be the first to share your thoughts!"}),e.jsx(i,{variant:"body2",color:"text.secondary",children:"No feedback has been submitted yet. Your opinion could be the first."})]}):e.jsx(p,{spacing:3,children:y.map((t,r)=>{var o,m,c,g,E,F,D;return e.jsx(s,{component:h.div,variants:k,custom:r,initial:"hidden",animate:"visible",exit:{opacity:0,y:20},children:e.jsx(Y,{elevation:0,sx:{borderRadius:3,border:`1px solid ${n(a.palette.divider,.6)}`,transition:"all 0.3s ease","&:hover":{borderColor:n(a.palette.primary.main,.3),boxShadow:`0 4px 20px ${n(a.palette.primary.main,.1)}`}},children:e.jsxs(L,{sx:{p:{xs:2,sm:3}},children:[e.jsxs(s,{sx:{display:"flex",justifyContent:"space-between",alignItems:{xs:"flex-start",sm:"center"},flexDirection:{xs:"column",sm:"row"},mb:2},children:[e.jsxs(p,{direction:"row",spacing:2,alignItems:"center",sx:{mb:{xs:1,sm:0}},children:[e.jsx(G,{alt:t.name||"anonymous",src:((o=t.userId)==null?void 0:o.profilePicture)||"",sx:{width:48,height:48,border:`2px solid ${n(a.palette.primary.main,.2)}`}}),e.jsxs(s,{children:[e.jsx(i,{variant:"subtitle1",fontWeight:600,children:t.name||((m=t.userId)==null?void 0:m.name)||"Anonymous User"}),e.jsx(V,{value:t.rating,readOnly:!0,size:"small",sx:{mt:.5}})]})]}),e.jsx(i,{variant:"caption",color:"text.secondary",sx:{mt:{xs:0,sm:.5}},children:B(t.createdAt)||"Recently"})]}),e.jsx(me,{sx:{mb:2}}),e.jsx(s,{sx:{py:1,px:{xs:0,sm:1},mb:3,minHeight:"60px"},children:e.jsx(i,{variant:"body1",children:t.comments})}),e.jsxs(p,{direction:"row",spacing:1,alignItems:"center",sx:{mb:2},children:[e.jsx(xe,{title:"Like this feedback",children:e.jsx(pe,{"aria-label":"like",onClick:()=>re(t._id),color:(c=t.likes)!=null&&c.includes(localStorage.getItem("userId")||"")?"primary":"default",sx:{borderRadius:2,transition:"transform 0.2s","&:hover":{transform:"scale(1.1)"}},children:(g=t.likes)!=null&&g.includes(localStorage.getItem("userId")||"")?e.jsx($e,{}):e.jsx(Ie,{})})}),e.jsxs(i,{variant:"body2",fontWeight:500,children:[((E=t.likes)==null?void 0:E.length)||0," likes"]}),e.jsx(s,{sx:{flexGrow:1}}),e.jsx(I,{icon:e.jsx(Q,{sx:{fontSize:"1rem !important"}}),label:`${((F=t.feedbackComments)==null?void 0:F.length)||0} comments`,size:"small",variant:"outlined",sx:{borderRadius:"12px",height:28}})]}),((D=t.feedbackComments)==null?void 0:D.length)>0&&e.jsxs(q,{elevation:0,sx:{bgcolor:`radial-gradient(circle, ${n(l,.2)} 0%, transparent 70%)`,p:2,borderRadius:2,mb:2,border:1,borderColor:"divider"},children:[e.jsxs(i,{variant:"subtitle2",sx:{mb:1.5,display:"flex",alignItems:"center",gap:.5},children:[e.jsx(Q,{fontSize:"small",color:"primary"}),"Comments"]}),e.jsx(p,{spacing:1.5,children:t.feedbackComments.map(d=>{var _,P,M;return e.jsxs(s,{sx:{display:"flex",gap:1.5},children:[e.jsx(G,{alt:((_=d.userId)==null?void 0:_.name)||"anonymous",src:((P=d.userId)==null?void 0:P.profilePicture)||"",sx:{width:32,height:32}}),e.jsxs(s,{sx:{flex:1},children:[e.jsxs(s,{sx:{bgcolor:`radial-gradient(circle, ${n(l,.2)} 0%, transparent 70%)`,p:1.5,borderRadius:"0 16px 16px 16px",border:1,borderColor:"divider"},children:[e.jsx(i,{variant:"body2",sx:{fontWeight:500,mb:.5},children:((M=d.userId)==null?void 0:M.name)||"Anonymous"}),e.jsx(i,{variant:"body2",children:d.comment})]}),e.jsx(i,{variant:"caption",color:"text.secondary",sx:{ml:1,mt:.5},children:B(d.createdAt)||"Recently"})]})]},d._id)})})]}),e.jsx(s,{component:"form",onSubmit:d=>{d.preventDefault(),te(t._id)},noValidate:!0,children:e.jsx(he,{placeholder:"Add a comment...",variant:"outlined",fullWidth:!0,size:"small",value:S[t._id]||"",onChange:d=>se(t._id,d.target.value),InputProps:{sx:{borderRadius:3},endAdornment:e.jsx(ue,{position:"end",children:e.jsx(O,{})})}})})]})})},t._id)})})})]})]})}),e.jsx(fe,{})]})]})]})}export{Pe as default};
